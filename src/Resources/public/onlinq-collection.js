(()=>{"use strict";function t(e){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}function e(t){return function(t){if(Array.isArray(t))return n(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return n(t,e);var o=Object.prototype.toString.call(t).slice(8,-1);return"Object"===o&&t.constructor&&(o=t.constructor.name),"Map"===o||"Set"===o?Array.from(t):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?n(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,o=new Array(e);n<e;n++)o[n]=t[n];return o}function o(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function i(e,n){if(n&&("object"===t(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");return r(e)}function r(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function l(t){var e="function"==typeof Map?new Map:void 0;return(l=function(t){if(null===t||(n=t,-1===Function.toString.call(n).indexOf("[native code]")))return t;var n;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==e){if(e.has(t))return e.get(t);e.set(t,o)}function o(){return a(t,arguments,u(this).constructor)}return o.prototype=Object.create(t.prototype,{constructor:{value:o,enumerable:!1,writable:!0,configurable:!0}}),s(o,t)})(t)}function a(t,e,n){return(a=c()?Reflect.construct:function(t,e,n){var o=[null];o.push.apply(o,e);var i=new(Function.bind.apply(t,o));return n&&s(i,n.prototype),i}).apply(null,arguments)}function c(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function s(t,e){return(s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function u(t){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function f(t,e){return function(t,e){return e.get?e.get.call(t):e.value}(t,y(t,e,"get"))}function h(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function d(t,e,n){return function(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}(t,y(t,e,"set"),n),n}function y(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}var p=new WeakMap,v=new WeakMap,m=new WeakMap,b=new WeakMap,w=new WeakMap,g=new WeakSet,A=new WeakSet,x=new WeakSet,k=new WeakSet,S=new WeakSet,E=new WeakSet,j=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&s(t,e)}(y,t);var e,n,l,a,f=(e=y,n=c(),function(){var t,o=u(e);if(n){var r=u(this).constructor;t=Reflect.construct(o,arguments,r)}else t=o.apply(this,arguments);return i(this,t)});function y(){var t,e,n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,y),t=f.call(this),E.add(r(t)),S.add(r(t)),k.add(r(t)),x.add(r(t)),A.add(r(t)),g.add(r(t)),!1,(n="nextIndex")in(e=r(t))?Object.defineProperty(e,n,{value:false,enumerable:!0,configurable:!0,writable:!0}):e[n]=false,p.set(r(t),{writable:!0,value:null}),v.set(r(t),{writable:!0,value:null}),m.set(r(t),{writable:!0,value:null}),b.set(r(t),{writable:!0,value:null}),w.set(r(t),{writable:!0,value:null}),t.attachShadow({mode:"open"}),d(r(t),w,T.bind(r(t))),t}return l=y,(a=[{key:"connectedCallback",value:function(){h(this,E,W).call(this),h(this,k,q).call(this),this.nextIndex=this.entries.length,this.max>0&&this.entries.length>=this.max&&this.disableAddButtons()}},{key:"disconnectedCallback",value:function(){h(this,S,_).call(this)}},{key:"name",get:function(){var t;return null!==(t=this.getAttribute("name"))&&void 0!==t?t:null},set:function(t){this.setAttribute("name",t)}},{key:"entries",get:function(){return Array.from(this.querySelectorAll(":scope > onlinq-collection-entry"))}},{key:"min",get:function(){var t;return+(null!==(t=this.getAttribute("min"))&&void 0!==t?t:0)},set:function(t){t?this.setAttribute("min",t.toString()):this.removeAttribute("min")}},{key:"max",get:function(){var t;return+(null!==(t=this.getAttribute("max"))&&void 0!==t?t:0)},set:function(t){t?this.setAttribute("max",t.toString()):this.removeAttribute("max")}},{key:"allowAdd",get:function(){return this.hasAttribute("allow-add")},set:function(t){t?this.setAttribute("allow-add","allow-add"):this.removeAttribute("allow-add")}},{key:"allowDelete",get:function(){return this.hasAttribute("allow-delete")},set:function(t){t?this.setAttribute("allow-delete","allow-delete"):this.removeAttribute("allow-delete")}},{key:"allowMove",get:function(){return this.hasAttribute("allow-move")},set:function(t){t?this.setAttribute("allow-move","allow-move"):this.removeAttribute("allow-move")}},{key:"prefix",get:function(){var t,e;return null!==(t=null!==(e=this.getAttribute("prefix"))&&void 0!==e?e:this.name)&&void 0!==t?t:null},set:function(t){t?this.setAttribute("prefix",t):this.removeAttribute("prefix")}},{key:"prototype",get:function(){var t,e,n=null;return this.name&&(n=this.querySelector('template[collection="'.concat(this.name,'"][collection-prototype]'))),n||(n=this.querySelector("template[collection-prototype]")),null!==(t=null===(e=n)||void 0===e?void 0:e.content)&&void 0!==t&&t}},{key:"prototypeName",get:function(){return this.hasAttribute("prototype-name")?this.getAttribute("prototype-name"):"__name__"},set:function(t){this.setAttribute("prototype-name",t)}},{key:"entry",value:function(t){return this.entries.find((function(e){return e.index===t.toString()}))}},{key:"addEntry",value:function(){if(!this.allowAdd)return console.error('Unable to create a new entry because the "allow-add" attribute is not present on the collection.'),null;if(!this.prototype)return console.error("Unable to create a new entry because there is no prototype entry template present."),null;if(0!==this.max&&this.entries.length>=this.max)return console.error("Unable to create a new entry because the maximum amount of entries has been reached."),null;var t=this.nextIndex++,e=this.prototype.cloneNode(!0),n=document.createElement("onlinq-collection-entry");return n.appendChild(e),n.collection=this,n.index=t,this.appendChild(n),this.dispatchEvent(new CustomEvent("entryAdded",{entry:n})),this.max>0&&this.entries.length>=this.max&&this.disableAddButtons(),this.min>0&&this.entries.length>this.min&&this.entries.forEach((function(t){t.enableDeleteButtons()})),h(this,A,M).call(this),n}},{key:"deleteEntry",value:function(t){if(this.allowDelete)if(0!==this.min&&this.entries.length<=this.min)console.error("Unable to delete an entry because the minimum amount of entries has been reached.");else{var e=this.entry(t);this.dispatchEvent(new CustomEvent("beforeEntryRemoved",{entry:e})),e.remove(),this.entries.forEach((function(e){e.index<t||(e.index=e.index-1)})),this.nextIndex--,this.dispatchEvent(new CustomEvent("entryRemoved")),this.max>0&&this.entries.length<this.max&&this.enableAddButtons(),this.min>0&&this.entries.length<=this.min&&this.entries.forEach((function(t){t.disableDeleteButtons()})),0===this.entries.length&&h(this,x,R).call(this)}else console.error('Unable to delete an entry because the "allow-delete" attribute is not present on the collection.')}},{key:"moveEntry",value:function(t,e){if(this.allowMove){var n=this.entry(t),o=this.entry(e);null!==n&&null!==o?(o.index="__swap__",n.index=e,o.index=t,e>t?this.insertBefore(o,n):this.insertBefore(n,o)):console.error("Unable to move an entry because either the source or target index is non-existent.")}else console.error('Unable to move an entry because the "allow-move" attribute is not present on the collection.')}},{key:"enableAddButtons",value:function(){h(this,g,O).call(this).forEach((function(t){t.removeAttribute("disabled"),t.classList.remove("disabled")}))}},{key:"disableAddButtons",value:function(){h(this,g,O).call(this).forEach((function(t){t.setAttribute("disabled","disabled"),t.classList.add("disabled")}))}}])&&o(l.prototype,a),y}(l(HTMLElement));function O(){var t=this;return[].concat(e(Array.from(this.shadowRoot.querySelectorAll("[collection-add]"))),e(Array.from(this.querySelectorAll("[collection-add]")))).filter((function(e){var n=e.getAttribute("collection");return!n||n===t.name}))}function M(){f(this,p).style.display="block",f(this,v).style.display="none"}function R(){f(this,p).style.display="none",f(this,v).style.display="block"}function q(){var t=this;this.allowAdd&&h(this,g,O).call(this).forEach((function(e){e.addEventListener("click",f(t,w))}))}function _(){var t=this;this.allowAdd&&h(this,g,O).call(this).forEach((function(e){e.removeEventListener("click",f(t,w))}))}function W(){this.shadowRoot.innerHTML='<style type="text/css">\n  :host {\n    --collection-display: block;\n    --collection-justify-content: flex-start;\n    --collection-align-items: flex-start;\n    --collection-contents-margin: 0 0 1rem;\n    --collection-contents-flex-grow: 1;\n    --collection-actions-margin: 0 0 1rem;\n    --collection-actions-flex-grow: 0;\n\n    display: var(--collection-display);\n    justify-content: var(--collection-justify-content);\n    align-items: var(--collection-align-items);\n  }\n\n  .contents {\n    flex-grow: var(--collection-contents-flex-grow);\n    margin: var(--collection-contents-margin);\n  }\n\n  .actions {\n    flex-grow: var(--collection-actions-flex-grow);\n    margin: var(--collection-actions-margin);\n  }\n\n  [data-collection],\n  [data-add] {\n    display: none;\n  }\n</style>\n\n<div class="contents" data-collection>\n  <slot></slot>\n</div>\n<div class="contents" data-placeholder>\n  <slot name="placeholder">\n    <span>No entries</span>\n  </slot>\n</div>\n<div class="actions" data-actions>\n  <slot name="actions">\n    <span data-add>\n      <slot name="add">\n        <button collection-add>Add</button>\n      </slot>\n    </span>\n  </slot>\n</div>\n',d(this,p,this.shadowRoot.querySelector("[data-collection]")),d(this,v,this.shadowRoot.querySelector("[data-placeholder]")),d(this,m,this.shadowRoot.querySelector("[data-actions]")),d(this,b,this.shadowRoot.querySelector("[data-add]")),this.entries.length>0&&h(this,A,M).call(this),this.allowAdd&&(f(this,b).style.display="inline")}function T(){this.addEntry()}function L(t){return(L="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function B(t){return function(t){if(Array.isArray(t))return D(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return D(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?D(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function D(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,o=new Array(e);n<e;n++)o[n]=t[n];return o}function P(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function C(t,e){if(e&&("object"===L(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return N(t)}function N(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function U(t){var e="function"==typeof Map?new Map:void 0;return(U=function(t){if(null===t||(n=t,-1===Function.toString.call(n).indexOf("[native code]")))return t;var n;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==e){if(e.has(t))return e.get(t);e.set(t,o)}function o(){return I(t,arguments,$(this).constructor)}return o.prototype=Object.create(t.prototype,{constructor:{value:o,enumerable:!1,writable:!0,configurable:!0}}),F(o,t)})(t)}function I(t,e,n){return(I=H()?Reflect.construct:function(t,e,n){var o=[null];o.push.apply(o,e);var i=new(Function.bind.apply(t,o));return n&&F(i,n.prototype),i}).apply(null,arguments)}function H(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function F(t,e){return(F=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function $(t){return($=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function z(t,e){return function(t,e){return e.get?e.get.call(t):e.value}(t,K(t,e,"get"))}function G(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function J(t,e,n){return function(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}(t,K(t,e,"set"),n),n}function K(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}customElements.define("onlinq-collection",j);var Q=new WeakMap,V=new WeakMap,X=new WeakMap,Y=new WeakMap,Z=new WeakMap,tt=new WeakMap,et=new WeakMap,nt=new WeakMap,ot=new WeakSet,it=new WeakSet,rt=new WeakSet,lt=new WeakSet,at=new WeakSet,ct=new WeakSet,st=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&F(t,e)}(l,t);var e,n,o,i,r=(e=l,n=H(),function(){var t,o=$(e);if(n){var i=$(this).constructor;t=Reflect.construct(o,arguments,i)}else t=o.apply(this,arguments);return C(this,t)});function l(){var t,e,n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,l),t=r.call(this),ct.add(N(t)),at.add(N(t)),lt.add(N(t)),rt.add(N(t)),it.add(N(t)),ot.add(N(t)),null,(n="collection")in(e=N(t))?Object.defineProperty(e,n,{value:null,enumerable:!0,configurable:!0,writable:!0}):e[n]=null,Q.set(N(t),{writable:!0,value:null}),V.set(N(t),{writable:!0,value:null}),X.set(N(t),{writable:!0,value:null}),Y.set(N(t),{writable:!0,value:null}),Z.set(N(t),{writable:!0,value:null}),tt.set(N(t),{writable:!0,value:null}),et.set(N(t),{writable:!0,value:null}),nt.set(N(t),{writable:!0,value:null}),t.attachShadow({mode:"open"}),J(N(t),tt,vt.bind(N(t))),J(N(t),et,mt.bind(N(t))),J(N(t),nt,bt.bind(N(t))),t}return o=l,(i=[{key:"connectedCallback",value:function(){null===this.collection&&(this.collection=this.collectionName?this.closest('onlinq-collection[name="'.concat(this.collectionName,'"]')):this.closest("onlinq-collection")),null!==this.collection&&null===this.collectionName&&this.collection.name&&this.setAttribute("collection",this.collection.name),G(this,ct,pt).call(this),G(this,lt,dt).call(this),this.collection&&this.collection.min>0&&this.collection.entries.length<=this.collection.min&&this.disableDeleteButtons()}},{key:"disconnectedCallback",value:function(){G(this,at,yt).call(this)}},{key:"collectionName",get:function(){var t;return null!==(t=this.getAttribute("collection"))&&void 0!==t?t:null}},{key:"index",get:function(){var t;return null!==(t=this.getAttribute("collection-index"))&&void 0!==t&&t},set:function(t){var e=this.index||this.collection.prototypeName;this.setAttribute("collection-index",t.toString());var n=this.querySelector("[collection-label]");n&&(n.innerHTML=t);var o=this.collection.getAttribute("id"),i=this.collection.prefix;o&&wt(this.querySelectorAll("*"),"".concat(o,"_").concat(e),"".concat(o,"_").concat(t)),i&&wt(this.querySelectorAll("*"),"".concat(i,"[").concat(e,"]"),"".concat(i,"[").concat(t,"]"))}},{key:"deleteEntry",value:function(){this.collection.deleteEntry(this.index)}},{key:"moveDown",value:function(){this.collection.moveEntry(+this.index,+this.index+1)}},{key:"moveUp",value:function(){this.collection.moveEntry(+this.index,+this.index-1)}},{key:"enableDeleteButtons",value:function(){G(this,ot,ut).call(this).forEach((function(t){t.removeAttribute("disabled"),t.classList.remove("disabled")}))}},{key:"disableDeleteButtons",value:function(){G(this,ot,ut).call(this).forEach((function(t){t.setAttribute("disabled","disabled"),t.classList.add("disabled")}))}}])&&P(o.prototype,i),l}(U(HTMLElement));function ut(){var t=this;return[].concat(B(Array.from(this.shadowRoot.querySelectorAll("[collection-delete]"))),B(Array.from(this.querySelectorAll("[collection-delete]")))).filter((function(e){var n=e.getAttribute("collection");return!n||n===t.collectionName}))}function ft(){var t=this;return[].concat(B(Array.from(this.shadowRoot.querySelectorAll("[collection-move-down]"))),B(Array.from(this.querySelectorAll("[collection-move-down]")))).filter((function(e){var n=e.getAttribute("collection");return!n||n===t.collectionName}))}function ht(){var t=this;return[].concat(B(Array.from(this.shadowRoot.querySelectorAll("[collection-move-up]"))),B(Array.from(this.querySelectorAll("[collection-move-up]")))).filter((function(e){var n=e.getAttribute("collection");return!n||n===t.collectionName}))}function dt(){var t=this;G(this,it,ft).call(this).forEach((function(e){e.addEventListener("click",z(t,et))})),G(this,rt,ht).call(this).forEach((function(e){e.addEventListener("click",z(t,nt))})),G(this,ot,ut).call(this).forEach((function(e){e.addEventListener("click",z(t,tt))}))}function yt(){var t=this;G(this,it,ft).call(this).forEach((function(e){e.removeEventListener("click",z(t,et))})),G(this,rt,ht).call(this).forEach((function(e){e.removeEventListener("click",z(t,nt))})),G(this,ot,ut).call(this).forEach((function(e){e.removeEventListener("click",z(t,tt))}))}function pt(){this.shadowRoot.innerHTML='<style type="text/css">\n  :host {\n    --collection-entry-display: block;\n    --collection-entry-justify-content: flex-start;\n    --collection-entry-align-items: flex-start;\n    --collection-entry-contents-margin: 0 0 1rem;\n    --collection-entry-contents-flex-grow: 1;\n    --collection-entry-actions-margin: 0 0 1rem;\n    --collection-entry-actions-flex-grow: 0;\n\n    display: var(--collection-entry-display);\n    justify-content: var(--collection-entry-justify-content);\n    align-items: var(--collection-entry-align-items);\n  }\n\n  .contents {\n    flex-grow: var(--collection-entry-contents-flex-grow);\n    margin: var(--collection-entry-contents-margin);\n  }\n\n  .actions {\n    flex-grow: var(--collection-entry-actions-flex-grow);\n    margin: var(--collection-entry-actions-margin);\n  }\n\n  [data-move-up],\n  [data-move-down],\n  [data-delete] {\n    display: none;\n  }\n</style>\n\n<div class="contents" data-entry>\n  <slot></slot>\n</div>\n<div class="actions" data-actions>\n  <slot name="actions">\n    <span data-move-up>\n      <slot name="move-up">\n        <button collection-move-up>Move up</button>\n      </slot>\n    </span>\n    <span data-move-down>\n      <slot name="move-down">\n        <button collection-move-down>Move down</button>\n      </slot>\n    </span>\n    <span data-delete>\n      <slot name="delete">\n        <button collection-delete>Delete</button>\n      </slot>\n    </span>\n  </slot>\n</div>\n',J(this,Q,this.shadowRoot.querySelector("[data-entry]")),J(this,V,this.shadowRoot.querySelector("[data-actions]")),J(this,X,this.shadowRoot.querySelector("[data-delete]")),J(this,Y,this.shadowRoot.querySelector("[data-move-down]")),J(this,Z,this.shadowRoot.querySelector("[data-move-up]")),this.collection&&(this.collection.allowMove&&(z(this,Z).style.display="inline",z(this,Y).style.display="inline"),this.collection.allowDelete&&(z(this,X).style.display="inline"))}function vt(){this.collection.allowDelete&&this.deleteEntry()}function mt(){this.collection.allowMove&&this.moveDown()}function bt(){this.collection.allowMove&&this.moveUp()}function wt(t,e,n){t.forEach((function(t){B(t.attributes).map((function(t){t.value.includes(e)&&(t.value=t.value.replace(e,n))}))}))}customElements.define("onlinq-collection-entry",st)})();